ESSN: Simulation of Lund Neutron Detector Test Facility
J.R.M.Annand 28th May 2013
J.R.M.Annand 11th June 2013

The simulation requires:
1) A recent version of Geant4, tested with 4.9.6.2
2) A recent version of ROOT, tested with v5.34.06
3) The cmake (and cmake-gui) system to build the executable ESSN

Build using cmake or cmake-gui. May require edit of CMakeLists.txt to set the
directory where the G4 libraries are stored. FindROOT.cmake assumes the
environmental variable $ROOTSYS is set, which specifies the directory where
ROOT is held. Use cmake "configure" and "generate" to create a Makefile. If
this fails try deleting the file CMakeCache.txt and try again. Choose linux
makefiles.
Note that cmake creates the Makefile. If using the GUI review the configuration
displayed on the GUI window.  To build ESSN type "make" to invoke the g++
compiler and linker.

Directories:
macros	G4 macros to control execution
data	parameters for simulation...dimensions etc.
root	ROOT files and data analysis macros
src	Source code .cc files
include	Source code .hh files

Once ESSN builds correctly, it can be run.

To invoke ESSN online just type ESSN. This will by default call the macro
vis.mac. This puts up a display of the simulation geometry and a G4 command 
shell. The current vis.mac is using a GL + Qt graphical interface. To use this
the G4 libraries need to be build with GL and QT support and naturally the
linux distribution also has to have these libraries.
From the command box one can run any command.....there is a help on the GUI
which lists all commands and their function. Try...
/control/execute macros/AmBeMovie.mac
This will generate and display 10 AmBe events. More can be displayed by e.g.
/run/beamOn 100

ESSN can also be run in batch mode, e.g....
ESSN macros/AmBe.mac
This does not create a display. The current AmBe.mac is generating events
according to a simple model I made (see ESSNPrimaryGeneratorAction). Neutron and
gamma (random directions) are tracked. There is also a macro ngFixedDir.mac
generates a neutron and gamma at fixed directions, down 2 of the ports in the
water tank. One can also read in particle 4-momenta generated by AcquMC
(part of AcquROOT). 
The macro AmBe.mac tells ESSN to dump the information produced by the simulation
event-by-event into a root file.
To analyse this file:
>cd root
>root
root [0]  .x ESSNanalyse.C("./AmBe_1MN_ESSN.root",6)

This will create 2 canvases, 1D histograms and 2D histograms. At the moment its
not that useful. You will want to develop it a bit....e.g. look at time
difference between YAP and organic scint, more as in the experiment. Note there
are no resolution effects applied yet...e.g. intrinsic pulse height or time
resolutions of detectors.

Happy simmulating!